<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Dijkstra.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Dijkstra.Specification.Transaction.html" class="Module">Ledger.Dijkstra.Specification.Transaction</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Ledger.Dijkstra.Specification.Abstract.html" class="Module">Ledger.Dijkstra.Specification.Abstract</a>

<a id="132" class="Keyword">module</a> <a id="139" href="Ledger.Dijkstra.Specification.Script.Validation.html" class="Module">Ledger.Dijkstra.Specification.Script.Validation</a>
  <a id="189" class="Symbol">(</a><a id="190" href="Ledger.Dijkstra.Specification.Script.Validation.html#190" class="Bound">txs</a> <a id="194" class="Symbol">:</a> <a id="196" class="Symbol">_)</a> <a id="199" class="Symbol">(</a><a id="200" class="Keyword">open</a> <a id="205" href="Ledger.Dijkstra.Specification.Transaction.html#1249" class="Module">TransactionStructure</a> <a id="226" href="Ledger.Dijkstra.Specification.Script.Validation.html#190" class="Bound">txs</a><a id="229" class="Symbol">)</a>
  <a id="233" class="Symbol">(</a><a id="234" href="Ledger.Dijkstra.Specification.Script.Validation.html#234" class="Bound">abs</a> <a id="238" class="Symbol">:</a> <a id="240" href="Ledger.Dijkstra.Specification.Abstract.html#726" class="Record">AbstractFunctions</a> <a id="258" href="Ledger.Dijkstra.Specification.Script.Validation.html#190" class="Bound">txs</a><a id="261" class="Symbol">)</a> <a id="263" class="Symbol">(</a><a id="264" class="Keyword">open</a> <a id="269" href="Ledger.Dijkstra.Specification.Abstract.html#726" class="Module">AbstractFunctions</a> <a id="287" href="Ledger.Dijkstra.Specification.Script.Validation.html#234" class="Bound">abs</a><a id="290" class="Symbol">)</a> <a id="292" class="Symbol">(</a><a id="293" class="Keyword">open</a> <a id="298" href="Ledger.Dijkstra.Specification.Abstract.html#289" class="Module">indexOf</a> <a id="306" href="Ledger.Dijkstra.Specification.Abstract.html#864" class="Field">indexOfImp</a><a id="316" class="Symbol">)</a>
  <a id="320" class="Keyword">where</a>

<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Ledger.Dijkstra.Specification.Certs.html" class="Module">Ledger.Dijkstra.Specification.Certs</a> <a id="402" href="Ledger.Dijkstra.Specification.Transaction.html#2293" class="Function">govStructure</a>

<a id="416" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="421" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="435" class="Symbol">:</a> <a id="437" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="442" class="Keyword">where</a>
  <a id="ScriptPurpose.Cert"></a><a id="450" href="Ledger.Dijkstra.Specification.Script.Validation.html#450" class="InductiveConstructor">Cert</a>     <a id="459" class="Symbol">:</a> <a id="461" href="Ledger.Conway.Specification.Certs.html#2238" class="Datatype">DCert</a>           <a id="477" class="Symbol">→</a> <a id="479" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Rwrd"></a><a id="495" href="Ledger.Dijkstra.Specification.Script.Validation.html#495" class="InductiveConstructor">Rwrd</a>     <a id="504" class="Symbol">:</a> <a id="506" href="Ledger.Dijkstra.Specification.Address.html#329" class="Record">RewardAddress</a>   <a id="522" class="Symbol">→</a> <a id="524" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Mint"></a><a id="540" href="Ledger.Dijkstra.Specification.Script.Validation.html#540" class="InductiveConstructor">Mint</a>     <a id="549" class="Symbol">:</a> <a id="551" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>      <a id="567" class="Symbol">→</a> <a id="569" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Spend"></a><a id="585" href="Ledger.Dijkstra.Specification.Script.Validation.html#585" class="InductiveConstructor">Spend</a>    <a id="594" class="Symbol">:</a> <a id="596" href="Ledger.Dijkstra.Specification.Transaction.html#2829" class="Function">TxIn</a>            <a id="612" class="Symbol">→</a> <a id="614" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Vote"></a><a id="630" href="Ledger.Dijkstra.Specification.Script.Validation.html#630" class="InductiveConstructor">Vote</a>     <a id="639" class="Symbol">:</a> <a id="641" href="Ledger.Conway.Specification.Gov.Actions.html#539" class="Record">GovVoter</a>        <a id="657" class="Symbol">→</a> <a id="659" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Propose"></a><a id="675" href="Ledger.Dijkstra.Specification.Script.Validation.html#675" class="InductiveConstructor">Propose</a>  <a id="684" class="Symbol">:</a> <a id="686" href="Ledger.Conway.Specification.Gov.Actions.html#3459" class="Record">GovProposal</a>     <a id="702" class="Symbol">→</a> <a id="704" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Guard"></a><a id="720" href="Ledger.Dijkstra.Specification.Script.Validation.html#720" class="InductiveConstructor">Guard</a>    <a id="729" class="Symbol">:</a> <a id="731" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>      <a id="747" class="Symbol">→</a> <a id="749" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a>

<a id="764" class="Keyword">private</a> <a id="772" class="Keyword">variable</a>
  <a id="783" href="Ledger.Dijkstra.Specification.Script.Validation.html#783" class="Generalizable">ℓ</a> <a id="785" class="Symbol">:</a> <a id="787" href="Ledger.Dijkstra.Specification.Transaction.html#688" class="Datatype">TxLevel</a>

<a id="rdptr"></a><a id="796" href="Ledger.Dijkstra.Specification.Script.Validation.html#796" class="Function">rdptr</a> <a id="802" class="Symbol">:</a> <a id="804" class="Symbol">(</a><a id="805" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Record">TxBody</a> <a id="812" href="Ledger.Dijkstra.Specification.Script.Validation.html#783" class="Generalizable">ℓ</a><a id="813" class="Symbol">)</a> <a id="815" class="Symbol">→</a> <a id="817" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="831" class="Symbol">→</a> <a id="833" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="839" class="Symbol">(</a><a id="840" href="Ledger.Dijkstra.Specification.Transaction.html#3091" class="Function">RedeemerPtr</a> <a id="852" href="Ledger.Dijkstra.Specification.Script.Validation.html#783" class="Generalizable">ℓ</a><a id="853" class="Symbol">)</a>
<a id="855" href="Ledger.Dijkstra.Specification.Script.Validation.html#796" class="Function">rdptr</a> <a id="861" href="Ledger.Dijkstra.Specification.Script.Validation.html#861" class="Bound">txb</a> <a id="865" class="Symbol">=</a> <a id="867" class="Symbol">λ</a> <a id="869" class="Keyword">where</a>
  <a id="877" class="Symbol">(</a><a id="878" href="Ledger.Dijkstra.Specification.Script.Validation.html#450" class="InductiveConstructor">Cert</a> <a id="883" href="Ledger.Dijkstra.Specification.Script.Validation.html#883" class="Bound">h</a><a id="884" class="Symbol">)</a>              <a id="899" class="Symbol">→</a> <a id="901" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="905" class="Symbol">(</a><a id="906" href="Ledger.Dijkstra.Specification.Transaction.html#1098" class="InductiveConstructor">Cert</a>    <a id="914" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="916" class="Symbol">)</a> <a id="918" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="920" href="Ledger.Dijkstra.Specification.Abstract.html#322" class="Function">indexOfDCert</a>    <a id="936" href="Ledger.Dijkstra.Specification.Script.Validation.html#883" class="Bound">h</a> <a id="938" href="Ledger.Dijkstra.Specification.Transaction.html#3978" class="Field">txCerts</a>
  <a id="948" class="Symbol">(</a><a id="949" href="Ledger.Dijkstra.Specification.Script.Validation.html#495" class="InductiveConstructor">Rwrd</a> <a id="954" href="Ledger.Dijkstra.Specification.Script.Validation.html#954" class="Bound">h</a><a id="955" class="Symbol">)</a>              <a id="970" class="Symbol">→</a> <a id="972" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="976" class="Symbol">(</a><a id="977" href="Ledger.Dijkstra.Specification.Transaction.html#1103" class="InductiveConstructor">Reward</a>   <a id="986" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="988" class="Symbol">)</a> <a id="990" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="992" href="Ledger.Dijkstra.Specification.Abstract.html#374" class="Function">indexOfRwdAddr</a>  <a id="1008" href="Ledger.Dijkstra.Specification.Script.Validation.html#954" class="Bound">h</a> <a id="1010" href="Ledger.Dijkstra.Specification.Transaction.html#4099" class="Field">txWithdrawals</a>
  <a id="1026" class="Symbol">(</a><a id="1027" href="Ledger.Dijkstra.Specification.Script.Validation.html#540" class="InductiveConstructor">Mint</a> <a id="1032" href="Ledger.Dijkstra.Specification.Script.Validation.html#1032" class="Bound">h</a><a id="1033" class="Symbol">)</a>              <a id="1048" class="Symbol">→</a> <a id="1050" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1054" class="Symbol">(</a><a id="1055" href="Ledger.Dijkstra.Specification.Transaction.html#1093" class="InductiveConstructor">Mint</a>    <a id="1063" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1065" class="Symbol">)</a> <a id="1067" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1069" href="Ledger.Dijkstra.Specification.Abstract.html#482" class="Function">indexOfPolicyId</a> <a id="1085" href="Ledger.Dijkstra.Specification.Script.Validation.html#1032" class="Bound">h</a> <a id="1087" class="Symbol">(</a><a id="1088" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="1097" href="Ledger.Dijkstra.Specification.Transaction.html#4461" class="Field">mint</a><a id="1101" class="Symbol">)</a>
  <a id="1105" class="Symbol">(</a><a id="1106" href="Ledger.Dijkstra.Specification.Script.Validation.html#585" class="InductiveConstructor">Spend</a> <a id="1112" href="Ledger.Dijkstra.Specification.Script.Validation.html#1112" class="Bound">h</a><a id="1113" class="Symbol">)</a>             <a id="1127" class="Symbol">→</a> <a id="1129" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1133" class="Symbol">(</a><a id="1134" href="Ledger.Dijkstra.Specification.Transaction.html#1087" class="InductiveConstructor">Spend</a>   <a id="1142" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1144" class="Symbol">)</a> <a id="1146" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1148" href="Ledger.Dijkstra.Specification.Abstract.html#435" class="Function">indexOfTxIn</a>     <a id="1164" href="Ledger.Dijkstra.Specification.Script.Validation.html#1112" class="Bound">h</a> <a id="1166" href="Ledger.Dijkstra.Specification.Transaction.html#3741" class="Field">txIns</a>
  <a id="1174" class="Symbol">(</a><a id="1175" href="Ledger.Dijkstra.Specification.Script.Validation.html#630" class="InductiveConstructor">Vote</a> <a id="1180" href="Ledger.Dijkstra.Specification.Script.Validation.html#1180" class="Bound">h</a><a id="1181" class="Symbol">)</a>              <a id="1196" class="Symbol">→</a> <a id="1198" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1202" class="Symbol">(</a><a id="1203" href="Ledger.Dijkstra.Specification.Transaction.html#1110" class="InductiveConstructor">Vote</a>    <a id="1211" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1213" class="Symbol">)</a> <a id="1215" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1217" href="Ledger.Dijkstra.Specification.Abstract.html#541" class="Function">indexOfVote</a>     <a id="1233" href="Ledger.Dijkstra.Specification.Script.Validation.html#1180" class="Bound">h</a> <a id="1235" class="Symbol">(</a><a id="1236" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1240" href="Ledger.Conway.Specification.Gov.Actions.html#3333" class="Field">GovVote.voter</a> <a id="1254" href="Ledger.Dijkstra.Specification.Transaction.html#4282" class="Field">txGovVotes</a><a id="1264" class="Symbol">)</a>
  <a id="1268" class="Symbol">(</a><a id="1269" href="Ledger.Dijkstra.Specification.Script.Validation.html#675" class="InductiveConstructor">Propose</a> <a id="1277" href="Ledger.Dijkstra.Specification.Script.Validation.html#1277" class="Bound">h</a><a id="1278" class="Symbol">)</a>           <a id="1290" class="Symbol">→</a> <a id="1292" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1296" class="Symbol">(</a><a id="1297" href="Ledger.Dijkstra.Specification.Transaction.html#1115" class="InductiveConstructor">Propose</a> <a id="1305" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1307" class="Symbol">)</a> <a id="1309" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1311" href="Ledger.Dijkstra.Specification.Abstract.html#599" class="Function">indexOfProposal</a> <a id="1327" href="Ledger.Dijkstra.Specification.Script.Validation.html#1277" class="Bound">h</a> <a id="1329" href="Ledger.Dijkstra.Specification.Transaction.html#4326" class="Field">txGovProposals</a>
  <a id="1346" class="Symbol">(</a><a id="1347" href="Ledger.Dijkstra.Specification.Script.Validation.html#720" class="InductiveConstructor">Guard</a> <a id="1353" href="Ledger.Dijkstra.Specification.Script.Validation.html#1353" class="Bound">h</a><a id="1354" class="Symbol">)</a>             <a id="1368" class="Symbol">→</a> <a id="1370" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1374" class="Symbol">(</a><a id="1375" href="Ledger.Dijkstra.Specification.Transaction.html#1123" class="InductiveConstructor">Guard</a>   <a id="1383" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1385" class="Symbol">)</a> <a id="1387" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1389" href="Ledger.Dijkstra.Specification.Abstract.html#663" class="Function">indexOfGuard</a>    <a id="1405" href="Ledger.Dijkstra.Specification.Script.Validation.html#1353" class="Bound">h</a> <a id="1407" href="Ledger.Dijkstra.Specification.Transaction.html#4676" class="Field">txRequiredGuards</a>
 <a id="1425" class="Keyword">where</a> <a id="1431" class="Keyword">open</a> <a id="1436" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Module">TxBody</a> <a id="1443" href="Ledger.Dijkstra.Specification.Script.Validation.html#861" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1448" href="Ledger.Dijkstra.Specification.Script.Validation.html#1448" class="Function">indexedRdmrs</a> <a id="1461" class="Symbol">:</a> <a id="1463" class="Symbol">(</a><a id="1464" href="Ledger.Dijkstra.Specification.Transaction.html#3418" class="Record">Tx</a> <a id="1467" href="Ledger.Dijkstra.Specification.Script.Validation.html#783" class="Generalizable">ℓ</a><a id="1468" class="Symbol">)</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1494" class="Symbol">(</a><a id="1495" href="Ledger.Conway.Specification.Script.Base.html#1788" class="Function">Redeemer</a> <a id="1504" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1506" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a><a id="1513" class="Symbol">)</a>
<a id="1515" href="Ledger.Dijkstra.Specification.Script.Validation.html#1448" class="Function">indexedRdmrs</a> <a id="1528" href="Ledger.Dijkstra.Specification.Script.Validation.html#1528" class="Bound">tx</a> <a id="1531" href="Ledger.Dijkstra.Specification.Script.Validation.html#1531" class="Bound">sp</a> <a id="1534" class="Symbol">=</a> <a id="1536" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1542" class="Symbol">(λ</a> <a id="1545" href="Ledger.Dijkstra.Specification.Script.Validation.html#1545" class="Bound">x</a> <a id="1547" class="Symbol">→</a> <a id="1549" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="1558" href="Ledger.Dijkstra.Specification.Transaction.html#5051" class="Function">txRedeemers</a> <a id="1570" href="Ledger.Dijkstra.Specification.Script.Validation.html#1545" class="Bound">x</a><a id="1571" class="Symbol">)</a> <a id="1573" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1581" class="Symbol">(</a><a id="1582" href="Ledger.Dijkstra.Specification.Script.Validation.html#796" class="Function">rdptr</a> <a id="1588" href="Ledger.Dijkstra.Specification.Transaction.html#3490" class="Function">txBody</a> <a id="1595" href="Ledger.Dijkstra.Specification.Script.Validation.html#1531" class="Bound">sp</a><a id="1597" class="Symbol">)</a>
  <a id="1601" class="Keyword">where</a> <a id="1607" class="Keyword">open</a> <a id="1612" href="Ledger.Dijkstra.Specification.Transaction.html#3418" class="Module">Tx</a> <a id="1615" href="Ledger.Dijkstra.Specification.Script.Validation.html#1528" class="Bound">tx</a><a id="1617" class="Symbol">;</a> <a id="1619" class="Keyword">open</a> <a id="1624" href="Ledger.Dijkstra.Specification.Transaction.html#4864" class="Module">TxWitnesses</a> <a id="1636" href="Ledger.Dijkstra.Specification.Transaction.html#3528" class="Function">txWitnesses</a>

<a id="getDatum"></a><a id="1649" href="Ledger.Dijkstra.Specification.Script.Validation.html#1649" class="Function">getDatum</a> <a id="1658" class="Symbol">:</a> <a id="1660" href="Ledger.Dijkstra.Specification.Transaction.html#3418" class="Record">Tx</a> <a id="1663" href="Ledger.Dijkstra.Specification.Script.Validation.html#783" class="Generalizable">ℓ</a> <a id="1665" class="Symbol">→</a> <a id="1667" href="Ledger.Dijkstra.Specification.Transaction.html#2944" class="Function">UTxO</a> <a id="1672" class="Symbol">→</a> <a id="1674" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="1688" class="Symbol">→</a> <a id="1690" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1696" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
<a id="1702" href="Ledger.Dijkstra.Specification.Script.Validation.html#1649" class="Function">getDatum</a> <a id="1711" href="Ledger.Dijkstra.Specification.Script.Validation.html#1711" class="Bound">tx</a> <a id="1714" href="Ledger.Dijkstra.Specification.Script.Validation.html#1714" class="Bound">utxo</a> <a id="1719" class="Symbol">(</a><a id="1720" href="Ledger.Dijkstra.Specification.Script.Validation.html#585" class="InductiveConstructor">Spend</a> <a id="1726" href="Ledger.Dijkstra.Specification.Script.Validation.html#1726" class="Bound">txin</a><a id="1730" class="Symbol">)</a> <a id="1732" class="Symbol">=</a>
  <a id="1736" class="Keyword">do</a> <a id="1739" class="Symbol">(_</a> <a id="1742" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1744" class="Symbol">_</a> <a id="1746" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1748" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1753" href="Ledger.Dijkstra.Specification.Script.Validation.html#1753" class="Bound">d</a> <a id="1755" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1757" class="Symbol">_)</a> <a id="1760" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1762" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="1771" href="Ledger.Dijkstra.Specification.Script.Validation.html#1714" class="Bound">utxo</a> <a id="1776" href="Ledger.Dijkstra.Specification.Script.Validation.html#1726" class="Bound">txin</a> <a id="1781" class="Keyword">where</a>
                            <a id="1815" class="Symbol">(_</a> <a id="1818" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1820" class="Symbol">_</a> <a id="1822" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1824" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1832" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1834" class="Symbol">_)</a> <a id="1837" class="Symbol">→</a> <a id="1839" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1852" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1857" href="Ledger.Dijkstra.Specification.Script.Validation.html#1753" class="Bound">d</a> <a id="1859" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1862" class="Symbol">λ</a> <a id="1864" class="Keyword">where</a>
       <a id="1877" class="Symbol">(</a><a id="1878" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1883" href="Ledger.Dijkstra.Specification.Script.Validation.html#1883" class="Bound">d</a><a id="1884" class="Symbol">)</a> <a id="1886" class="Symbol">→</a> <a id="1888" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1893" href="Ledger.Dijkstra.Specification.Script.Validation.html#1883" class="Bound">d</a>
       <a id="1902" class="Symbol">(</a><a id="1903" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1908" href="Ledger.Dijkstra.Specification.Script.Validation.html#1908" class="Bound">h</a><a id="1909" class="Symbol">)</a> <a id="1911" class="Symbol">→</a> <a id="1913" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="1922" class="Symbol">(</a><a id="1923" href="Ledger.Prelude.html#1740" class="Function">setToMap</a> <a id="1932" class="Symbol">(</a><a id="1933" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1938" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1940" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="1945" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1947" href="Function.Base.html#704" class="Function">id</a> <a id="1950" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1952" class="Symbol">(</a><a id="1953" href="Ledger.Dijkstra.Specification.Transaction.html#5885" class="Field">DataOf</a> <a id="1960" href="Ledger.Dijkstra.Specification.Script.Validation.html#1711" class="Bound">tx</a><a id="1962" class="Symbol">)))</a> <a id="1966" href="Ledger.Dijkstra.Specification.Script.Validation.html#1908" class="Bound">h</a>
<a id="1968" href="Ledger.Dijkstra.Specification.Script.Validation.html#1649" class="CatchallClause Function">getDatum</a><a id="1976" class="CatchallClause"> </a><a id="1977" href="Ledger.Dijkstra.Specification.Script.Validation.html#1977" class="CatchallClause Bound">tx</a><a id="1979" class="CatchallClause"> </a><a id="1980" href="Ledger.Dijkstra.Specification.Script.Validation.html#1980" class="CatchallClause Bound">utxo</a><a id="1984" class="CatchallClause"> </a><a id="1985" class="CatchallClause Symbol">_</a> <a id="1987" class="Symbol">=</a> <a id="1989" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="1998" class="Keyword">record</a> <a id="TxInfo"></a><a id="2005" href="Ledger.Dijkstra.Specification.Script.Validation.html#2005" class="Record">TxInfo</a> <a id="2012" class="Symbol">:</a> <a id="2014" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2019" class="Keyword">where</a>
  <a id="2027" class="Keyword">field</a> <a id="TxInfo.realizedInputs"></a><a id="2033" href="Ledger.Dijkstra.Specification.Script.Validation.html#2033" class="Field">realizedInputs</a> <a id="2048" class="Symbol">:</a> <a id="2050" href="Ledger.Dijkstra.Specification.Transaction.html#2944" class="Function">UTxO</a>
        <a id="TxInfo.txOuts"></a><a id="2063" href="Ledger.Dijkstra.Specification.Script.Validation.html#2063" class="Field">txOuts</a>         <a id="2078" class="Symbol">:</a> <a id="2080" href="Ledger.Dijkstra.Specification.Transaction.html#1296" class="Field">Ix</a> <a id="2083" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2085" href="Ledger.Dijkstra.Specification.Transaction.html#2863" class="Function">TxOut</a>
        <a id="TxInfo.txFee"></a><a id="2099" href="Ledger.Dijkstra.Specification.Script.Validation.html#2099" class="Field">txFee</a>          <a id="2114" class="Symbol">:</a> <a id="2116" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2122" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
        <a id="TxInfo.mint"></a><a id="2135" href="Ledger.Dijkstra.Specification.Script.Validation.html#2135" class="Field">mint</a>           <a id="2150" class="Symbol">:</a> <a id="2152" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#518" class="Function">Value</a>
        <a id="TxInfo.txCerts"></a><a id="2166" href="Ledger.Dijkstra.Specification.Script.Validation.html#2166" class="Field">txCerts</a>        <a id="2181" class="Symbol">:</a> <a id="2183" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2188" href="Ledger.Conway.Specification.Certs.html#2238" class="Datatype">DCert</a>
        <a id="TxInfo.txWithdrawals"></a><a id="2202" href="Ledger.Dijkstra.Specification.Script.Validation.html#2202" class="Field">txWithdrawals</a>  <a id="2217" class="Symbol">:</a> <a id="2219" href="Ledger.Dijkstra.Specification.Transaction.html#2981" class="Function">Withdrawals</a>
        <a id="TxInfo.txVldt"></a><a id="2239" href="Ledger.Dijkstra.Specification.Script.Validation.html#2239" class="Field">txVldt</a>         <a id="2254" class="Symbol">:</a> <a id="2256" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2262" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a> <a id="2267" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2269" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2275" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a>
        <a id="TxInfo.vkKey"></a><a id="2288" href="Ledger.Dijkstra.Specification.Script.Validation.html#2288" class="Field">vkKey</a>          <a id="2303" class="Symbol">:</a> <a id="2305" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2307" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>
        <a id="TxInfo.txData"></a><a id="2326" href="Ledger.Dijkstra.Specification.Script.Validation.html#2326" class="Field">txData</a>         <a id="2341" class="Symbol">:</a> <a id="2343" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2345" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
        <a id="TxInfo.txId"></a><a id="2359" href="Ledger.Dijkstra.Specification.Script.Validation.html#2359" class="Field">txId</a>           <a id="2374" class="Symbol">:</a> <a id="2376" href="Ledger.Dijkstra.Specification.Transaction.html#1299" class="Field">TxId</a>


<a id="txInfo"></a><a id="2383" href="Ledger.Dijkstra.Specification.Script.Validation.html#2383" class="Function">txInfo</a> <a id="2390" class="Symbol">:</a> <a id="2392" class="Symbol">(</a><a id="2393" href="Ledger.Dijkstra.Specification.Script.Validation.html#2393" class="Bound">ℓ</a> <a id="2395" class="Symbol">:</a> <a id="2397" href="Ledger.Dijkstra.Specification.Transaction.html#688" class="Datatype">TxLevel</a><a id="2404" class="Symbol">)</a> <a id="2406" class="Symbol">→</a> <a id="2408" href="Ledger.Dijkstra.Specification.Transaction.html#2944" class="Function">UTxO</a> <a id="2413" class="Symbol">→</a> <a id="2415" href="Ledger.Dijkstra.Specification.Transaction.html#3418" class="Record">Tx</a> <a id="2418" href="Ledger.Dijkstra.Specification.Script.Validation.html#2393" class="Bound">ℓ</a> <a id="2420" class="Symbol">→</a> <a id="2422" href="Ledger.Dijkstra.Specification.Script.Validation.html#2005" class="Record">TxInfo</a>

<a id="2430" href="Ledger.Dijkstra.Specification.Script.Validation.html#2383" class="Function">txInfo</a> <a id="2437" href="Ledger.Dijkstra.Specification.Transaction.html#711" class="InductiveConstructor">TxLevelTop</a> <a id="2448" href="Ledger.Dijkstra.Specification.Script.Validation.html#2448" class="Bound">utxo</a> <a id="2453" href="Ledger.Dijkstra.Specification.Script.Validation.html#2453" class="Bound">tx</a> <a id="2456" class="Symbol">=</a>
  <a id="2460" class="Keyword">record</a>  <a id="2468" class="Symbol">{</a> <a id="2470" href="Ledger.Dijkstra.Specification.Script.Validation.html#2033" class="Field">realizedInputs</a> <a id="2485" class="Symbol">=</a> <a id="2487" href="Ledger.Dijkstra.Specification.Script.Validation.html#2448" class="Bound">utxo</a> <a id="2492" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2494" href="Ledger.Dijkstra.Specification.Transaction.html#3741" class="Function">txIns</a>
          <a id="2510" class="Symbol">;</a> <a id="2512" href="Ledger.Dijkstra.Specification.Script.Validation.html#2063" class="Field">txOuts</a> <a id="2519" class="Symbol">=</a> <a id="2521" href="Ledger.Dijkstra.Specification.Transaction.html#3900" class="Function">txOuts</a>
          <a id="2538" class="Symbol">;</a> <a id="2540" href="Ledger.Dijkstra.Specification.Script.Validation.html#2099" class="Field">txFee</a> <a id="2546" class="Symbol">=</a> <a id="2548" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2553" href="Ledger.Dijkstra.Specification.Transaction.html#4020" class="Function">txFee</a>
          <a id="2569" class="Symbol">;</a> <a id="2571" href="Ledger.Dijkstra.Specification.Script.Validation.html#2135" class="Field">mint</a> <a id="2576" class="Symbol">=</a> <a id="2578" href="Ledger.Dijkstra.Specification.Transaction.html#4461" class="Function">mint</a>
          <a id="2593" class="Symbol">;</a> <a id="2595" href="Ledger.Dijkstra.Specification.Script.Validation.html#2166" class="Field">txCerts</a> <a id="2603" class="Symbol">=</a> <a id="2605" href="Ledger.Dijkstra.Specification.Transaction.html#3978" class="Function">txCerts</a>
          <a id="2623" class="Symbol">;</a> <a id="2625" href="Ledger.Dijkstra.Specification.Script.Validation.html#2202" class="Field">txWithdrawals</a> <a id="2639" class="Symbol">=</a> <a id="2641" href="Ledger.Dijkstra.Specification.Transaction.html#4099" class="Function">txWithdrawals</a>
          <a id="2665" class="Symbol">;</a> <a id="2667" href="Ledger.Dijkstra.Specification.Script.Validation.html#2239" class="Field">txVldt</a> <a id="2674" class="Symbol">=</a> <a id="2676" href="Ledger.Dijkstra.Specification.Transaction.html#4142" class="Function">txVldt</a>
          <a id="2693" class="Symbol">;</a> <a id="2695" href="Ledger.Dijkstra.Specification.Script.Validation.html#2288" class="Field">vkKey</a> <a id="2701" class="Symbol">=</a> <a id="2703" href="Ledger.Dijkstra.Specification.Transaction.html#4676" class="Function">txRequiredGuards</a>
          <a id="2730" class="Symbol">;</a> <a id="2732" href="Ledger.Dijkstra.Specification.Script.Validation.html#2326" class="Field">txData</a> <a id="2739" class="Symbol">=</a> <a id="2741" href="Ledger.Dijkstra.Specification.Transaction.html#5885" class="Field">DataOf</a> <a id="2748" href="Ledger.Dijkstra.Specification.Script.Validation.html#2453" class="Bound">tx</a>
          <a id="2761" class="Symbol">;</a> <a id="2763" href="Ledger.Dijkstra.Specification.Script.Validation.html#2359" class="Field">txId</a> <a id="2768" class="Symbol">=</a> <a id="2770" href="Ledger.Dijkstra.Specification.Transaction.html#3942" class="Function">txId</a>
          <a id="2785" class="Symbol">}</a> <a id="2787" class="Keyword">where</a> <a id="2793" class="Keyword">open</a> <a id="2798" href="Ledger.Dijkstra.Specification.Transaction.html#3418" class="Module">Tx</a> <a id="2801" href="Ledger.Dijkstra.Specification.Script.Validation.html#2453" class="Bound">tx</a><a id="2803" class="Symbol">;</a> <a id="2805" class="Keyword">open</a> <a id="2810" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Module">TxBody</a> <a id="2817" href="Ledger.Dijkstra.Specification.Transaction.html#3490" class="Field">txBody</a>

<a id="2825" href="Ledger.Dijkstra.Specification.Script.Validation.html#2383" class="Function">txInfo</a> <a id="2832" href="Ledger.Dijkstra.Specification.Transaction.html#722" class="InductiveConstructor">TxLevelSub</a> <a id="2843" href="Ledger.Dijkstra.Specification.Script.Validation.html#2843" class="Bound">utxo</a> <a id="2848" href="Ledger.Dijkstra.Specification.Script.Validation.html#2848" class="Bound">tx</a> <a id="2851" class="Symbol">=</a>
  <a id="2855" class="Keyword">record</a>  <a id="2863" class="Symbol">{</a> <a id="2865" href="Ledger.Dijkstra.Specification.Script.Validation.html#2033" class="Field">realizedInputs</a> <a id="2880" class="Symbol">=</a> <a id="2882" href="Ledger.Dijkstra.Specification.Script.Validation.html#2843" class="Bound">utxo</a> <a id="2887" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2889" href="Ledger.Dijkstra.Specification.Transaction.html#3741" class="Function">txIns</a>
          <a id="2905" class="Symbol">;</a> <a id="2907" href="Ledger.Dijkstra.Specification.Script.Validation.html#2063" class="Field">txOuts</a> <a id="2914" class="Symbol">=</a> <a id="2916" href="Ledger.Dijkstra.Specification.Transaction.html#3900" class="Function">txOuts</a>
          <a id="2933" class="Symbol">;</a> <a id="2935" href="Ledger.Dijkstra.Specification.Script.Validation.html#2099" class="Field">txFee</a> <a id="2941" class="Symbol">=</a> <a id="2943" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
          <a id="2961" class="Symbol">;</a> <a id="2963" href="Ledger.Dijkstra.Specification.Script.Validation.html#2135" class="Field">mint</a> <a id="2968" class="Symbol">=</a> <a id="2970" href="Ledger.Dijkstra.Specification.Transaction.html#4461" class="Function">mint</a>
          <a id="2985" class="Symbol">;</a> <a id="2987" href="Ledger.Dijkstra.Specification.Script.Validation.html#2166" class="Field">txCerts</a> <a id="2995" class="Symbol">=</a> <a id="2997" href="Ledger.Dijkstra.Specification.Transaction.html#3978" class="Function">txCerts</a>
          <a id="3015" class="Symbol">;</a> <a id="3017" href="Ledger.Dijkstra.Specification.Script.Validation.html#2202" class="Field">txWithdrawals</a> <a id="3031" class="Symbol">=</a> <a id="3033" href="Ledger.Dijkstra.Specification.Transaction.html#4099" class="Function">txWithdrawals</a>
          <a id="3057" class="Symbol">;</a> <a id="3059" href="Ledger.Dijkstra.Specification.Script.Validation.html#2239" class="Field">txVldt</a> <a id="3066" class="Symbol">=</a> <a id="3068" href="Ledger.Dijkstra.Specification.Transaction.html#4142" class="Function">txVldt</a>
          <a id="3085" class="Symbol">;</a> <a id="3087" href="Ledger.Dijkstra.Specification.Script.Validation.html#2288" class="Field">vkKey</a> <a id="3093" class="Symbol">=</a> <a id="3095" href="Ledger.Dijkstra.Specification.Transaction.html#4676" class="Function">txRequiredGuards</a>
          <a id="3122" class="Symbol">;</a> <a id="3124" href="Ledger.Dijkstra.Specification.Script.Validation.html#2326" class="Field">txData</a> <a id="3131" class="Symbol">=</a> <a id="3133" href="Ledger.Dijkstra.Specification.Transaction.html#5885" class="Field">DataOf</a> <a id="3140" href="Ledger.Dijkstra.Specification.Script.Validation.html#2848" class="Bound">tx</a>
          <a id="3153" class="Symbol">;</a> <a id="3155" href="Ledger.Dijkstra.Specification.Script.Validation.html#2359" class="Field">txId</a> <a id="3160" class="Symbol">=</a> <a id="3162" href="Ledger.Dijkstra.Specification.Transaction.html#3942" class="Function">txId</a>
          <a id="3177" class="Symbol">}</a> <a id="3179" class="Keyword">where</a> <a id="3185" class="Keyword">open</a> <a id="3190" href="Ledger.Dijkstra.Specification.Transaction.html#3418" class="Module">Tx</a> <a id="3193" href="Ledger.Dijkstra.Specification.Script.Validation.html#2848" class="Bound">tx</a><a id="3195" class="Symbol">;</a> <a id="3197" class="Keyword">open</a> <a id="3202" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Module">TxBody</a> <a id="3209" href="Ledger.Dijkstra.Specification.Transaction.html#3490" class="Field">txBody</a>

<a id="credsNeededMinusCollateral"></a><a id="3217" href="Ledger.Dijkstra.Specification.Script.Validation.html#3217" class="Function">credsNeededMinusCollateral</a> <a id="3244" class="Symbol">:</a> <a id="3246" class="Symbol">{</a><a id="3247" href="Ledger.Dijkstra.Specification.Script.Validation.html#3247" class="Bound">ℓ</a> <a id="3249" class="Symbol">:</a> <a id="3251" href="Ledger.Dijkstra.Specification.Transaction.html#688" class="Datatype">TxLevel</a><a id="3258" class="Symbol">}</a> <a id="3260" class="Symbol">→</a> <a id="3262" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Record">TxBody</a> <a id="3269" href="Ledger.Dijkstra.Specification.Script.Validation.html#3247" class="Bound">ℓ</a> <a id="3271" class="Symbol">→</a> <a id="3273" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3275" class="Symbol">(</a><a id="3276" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="3290" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3292" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a><a id="3302" class="Symbol">)</a>
<a id="3304" href="Ledger.Dijkstra.Specification.Script.Validation.html#3217" class="Function">credsNeededMinusCollateral</a> <a id="3331" href="Ledger.Dijkstra.Specification.Script.Validation.html#3331" class="Bound">txb</a> <a id="3335" class="Symbol">=</a> <a id="3337" href="Ledger.Dijkstra.Specification.Script.Validation.html#3365" class="Function">a</a> <a id="3339" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="3341" href="Ledger.Dijkstra.Specification.Script.Validation.html#3367" class="Function">b</a> <a id="3343" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="3345" href="Ledger.Dijkstra.Specification.Script.Validation.html#3369" class="Function">c</a> <a id="3347" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="3349" href="Ledger.Dijkstra.Specification.Script.Validation.html#3371" class="Function">d</a> <a id="3351" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="3353" href="Ledger.Dijkstra.Specification.Script.Validation.html#3373" class="Function">e</a>
  <a id="3357" class="Keyword">where</a>
  <a id="3365" href="Ledger.Dijkstra.Specification.Script.Validation.html#3365" class="Function">a</a> <a id="3367" href="Ledger.Dijkstra.Specification.Script.Validation.html#3367" class="Function">b</a> <a id="3369" href="Ledger.Dijkstra.Specification.Script.Validation.html#3369" class="Function">c</a> <a id="3371" href="Ledger.Dijkstra.Specification.Script.Validation.html#3371" class="Function">d</a> <a id="3373" href="Ledger.Dijkstra.Specification.Script.Validation.html#3373" class="Function">e</a> <a id="3375" class="Symbol">:</a> <a id="3377" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3379" class="Symbol">(</a><a id="3380" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="3394" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3396" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a><a id="3406" class="Symbol">)</a>
  <a id="3410" href="Ledger.Dijkstra.Specification.Script.Validation.html#3365" class="Function">a</a> <a id="3412" class="Symbol">=</a> <a id="3414" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3419" class="Symbol">(λ</a> <a id="3422" href="Ledger.Dijkstra.Specification.Script.Validation.html#3422" class="Bound">a</a> <a id="3424" class="Symbol">→</a> <a id="3426" class="Symbol">(</a><a id="3427" href="Ledger.Dijkstra.Specification.Script.Validation.html#495" class="InductiveConstructor">Rwrd</a> <a id="3432" href="Ledger.Dijkstra.Specification.Script.Validation.html#3422" class="Bound">a</a> <a id="3434" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3436" href="Ledger.Core.Specification.Address.html#423" class="Field">CredentialOf</a> <a id="3449" href="Ledger.Dijkstra.Specification.Script.Validation.html#3422" class="Bound">a</a><a id="3450" class="Symbol">))</a> <a id="3453" class="Symbol">(</a><a id="3454" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3458" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="3460" href="Ledger.Core.Specification.Address.html#1701" class="Field">WithdrawalsOf</a> <a id="3474" href="Ledger.Dijkstra.Specification.Script.Validation.html#3331" class="Bound">txb</a> <a id="3478" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a><a id="3479" class="Symbol">)</a>
  <a id="3483" href="Ledger.Dijkstra.Specification.Script.Validation.html#3367" class="Function">b</a> <a id="3485" class="Symbol">=</a> <a id="3487" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3498" class="Symbol">(λ</a> <a id="3501" href="Ledger.Dijkstra.Specification.Script.Validation.html#3501" class="Bound">c</a> <a id="3503" class="Symbol">→</a> <a id="3505" class="Symbol">(</a><a id="3506" href="Ledger.Dijkstra.Specification.Script.Validation.html#450" class="InductiveConstructor">Cert</a> <a id="3511" href="Ledger.Dijkstra.Specification.Script.Validation.html#3501" class="Bound">c</a> <a id="3513" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="3515" class="Symbol">)</a> <a id="3517" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="3521" href="Ledger.Conway.Specification.Certs.html#2993" class="Function">cwitness</a> <a id="3530" href="Ledger.Dijkstra.Specification.Script.Validation.html#3501" class="Bound">c</a><a id="3531" class="Symbol">)</a> <a id="3533" class="Symbol">(</a><a id="3534" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3543" class="Symbol">(</a><a id="3544" href="Ledger.Dijkstra.Specification.Transaction.html#5769" class="Field">DCertsOf</a> <a id="3553" href="Ledger.Dijkstra.Specification.Script.Validation.html#3331" class="Bound">txb</a><a id="3556" class="Symbol">))</a>
  <a id="3561" href="Ledger.Dijkstra.Specification.Script.Validation.html#3369" class="Function">c</a> <a id="3563" class="Symbol">=</a> <a id="3565" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3570" class="Symbol">(λ</a> <a id="3573" href="Ledger.Dijkstra.Specification.Script.Validation.html#3573" class="Bound">x</a> <a id="3575" class="Symbol">→</a> <a id="3577" class="Symbol">(</a><a id="3578" href="Ledger.Dijkstra.Specification.Script.Validation.html#540" class="InductiveConstructor">Mint</a> <a id="3583" href="Ledger.Dijkstra.Specification.Script.Validation.html#3573" class="Bound">x</a> <a id="3585" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3587" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="3597" href="Ledger.Dijkstra.Specification.Script.Validation.html#3573" class="Bound">x</a><a id="3598" class="Symbol">))</a> <a id="3601" class="Symbol">(</a><a id="3602" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="3611" class="Symbol">(</a><a id="3612" href="Ledger.Dijkstra.Specification.Transaction.html#6147" class="Field">ValueOf</a> <a id="3620" href="Ledger.Dijkstra.Specification.Script.Validation.html#3331" class="Bound">txb</a><a id="3623" class="Symbol">))</a>
  <a id="3628" href="Ledger.Dijkstra.Specification.Script.Validation.html#3371" class="Function">d</a> <a id="3630" class="Symbol">=</a> <a id="3632" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3643" class="Symbol">(λ</a> <a id="3646" href="Ledger.Dijkstra.Specification.Script.Validation.html#3646" class="Bound">v</a> <a id="3648" class="Symbol">→</a> <a id="3650" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3653" href="Ledger.Conway.Specification.Gov.Actions.html#6698" class="Function">isGovVoterCredential</a> <a id="3674" href="Ledger.Dijkstra.Specification.Script.Validation.html#3646" class="Bound">v</a> <a id="3676" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3681" class="Symbol">(λ</a> <a id="3684" class="Symbol">{</a><a id="3685" href="Ledger.Dijkstra.Specification.Script.Validation.html#3685" class="Bound">c</a><a id="3686" class="Symbol">}</a> <a id="3688" class="Symbol">→</a> <a id="3690" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3695" class="Symbol">(</a><a id="3696" href="Ledger.Dijkstra.Specification.Script.Validation.html#630" class="InductiveConstructor">Vote</a> <a id="3701" href="Ledger.Dijkstra.Specification.Script.Validation.html#3646" class="Bound">v</a> <a id="3703" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3705" href="Ledger.Dijkstra.Specification.Script.Validation.html#3685" class="Bound">c</a><a id="3706" class="Symbol">))</a> <a id="3709" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3714" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3721" class="Symbol">)</a>
                 <a id="3740" class="Symbol">(</a><a id="3741" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3750" class="Symbol">(</a><a id="3751" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3755" href="Ledger.Conway.Specification.Gov.Actions.html#4045" class="Field">GovVoterOf</a> <a id="3766" class="Symbol">(</a><a id="3767" href="Ledger.Dijkstra.Specification.Transaction.html#6402" class="Field">GovVotesOf</a> <a id="3778" href="Ledger.Dijkstra.Specification.Script.Validation.html#3331" class="Bound">txb</a><a id="3781" class="Symbol">)))</a>
  <a id="3787" href="Ledger.Dijkstra.Specification.Script.Validation.html#3373" class="Function">e</a> <a id="3789" class="Symbol">=</a> <a id="3791" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3802" class="Symbol">(λ</a> <a id="3805" href="Ledger.Dijkstra.Specification.Script.Validation.html#3805" class="Bound">p</a> <a id="3807" class="Symbol">→</a> <a id="3809" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3812" href="Ledger.Conway.Specification.Gov.Actions.html#4259" class="Field">PolicyOf</a> <a id="3821" href="Ledger.Dijkstra.Specification.Script.Validation.html#3805" class="Bound">p</a> <a id="3823" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3828" class="Symbol">(λ</a> <a id="3831" class="Symbol">{</a><a id="3832" href="Ledger.Dijkstra.Specification.Script.Validation.html#3832" class="Bound">sh</a><a id="3834" class="Symbol">}</a> <a id="3836" class="Symbol">→</a> <a id="3838" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3843" class="Symbol">(</a><a id="3844" href="Ledger.Dijkstra.Specification.Script.Validation.html#675" class="InductiveConstructor">Propose</a>  <a id="3853" href="Ledger.Dijkstra.Specification.Script.Validation.html#3805" class="Bound">p</a> <a id="3855" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3857" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="3867" href="Ledger.Dijkstra.Specification.Script.Validation.html#3832" class="Bound">sh</a><a id="3869" class="Symbol">))</a> <a id="3872" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3877" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3884" class="Symbol">)</a>
                 <a id="3903" class="Symbol">(</a><a id="3904" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3913" class="Symbol">(</a><a id="3914" href="Ledger.Dijkstra.Specification.Transaction.html#6264" class="Field">GovProposalsOf</a> <a id="3929" href="Ledger.Dijkstra.Specification.Script.Validation.html#3331" class="Bound">txb</a><a id="3932" class="Symbol">))</a>

<a id="credsNeeded"></a><a id="3936" href="Ledger.Dijkstra.Specification.Script.Validation.html#3936" class="Function">credsNeeded</a> <a id="3948" class="Symbol">:</a> <a id="3950" class="Symbol">(</a><a id="3951" href="Ledger.Dijkstra.Specification.Script.Validation.html#3951" class="Bound">ℓ</a> <a id="3953" class="Symbol">:</a> <a id="3955" href="Ledger.Dijkstra.Specification.Transaction.html#688" class="Datatype">TxLevel</a><a id="3962" class="Symbol">)</a> <a id="3964" class="Symbol">→</a> <a id="3966" href="Ledger.Dijkstra.Specification.Transaction.html#2944" class="Function">UTxO</a> <a id="3971" class="Symbol">→</a> <a id="3973" class="Symbol">(</a><a id="3974" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Record">TxBody</a> <a id="3981" href="Ledger.Dijkstra.Specification.Script.Validation.html#3951" class="Bound">ℓ</a><a id="3982" class="Symbol">)</a> <a id="3984" class="Symbol">→</a> <a id="3986" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3988" class="Symbol">(</a><a id="3989" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="4003" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4005" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a><a id="4015" class="Symbol">)</a>
<a id="4017" href="Ledger.Dijkstra.Specification.Script.Validation.html#3936" class="Function">credsNeeded</a> <a id="4029" href="Ledger.Dijkstra.Specification.Transaction.html#711" class="InductiveConstructor">TxLevelTop</a> <a id="4040" href="Ledger.Dijkstra.Specification.Script.Validation.html#4040" class="Bound">utxo</a> <a id="4045" href="Ledger.Dijkstra.Specification.Script.Validation.html#4045" class="Bound">txb</a> <a id="4049" class="Symbol">=</a> <a id="4051" href="Ledger.Dijkstra.Specification.Script.Validation.html#3217" class="Function">credsNeededMinusCollateral</a> <a id="4078" href="Ledger.Dijkstra.Specification.Script.Validation.html#4045" class="Bound">txb</a>
  <a id="4084" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="4086" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4091" class="Symbol">(λ</a> <a id="4094" class="Symbol">(</a><a id="4095" href="Ledger.Dijkstra.Specification.Script.Validation.html#4095" class="Bound">i</a> <a id="4097" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4099" href="Ledger.Dijkstra.Specification.Script.Validation.html#4099" class="Bound">o</a><a id="4100" class="Symbol">)</a> <a id="4102" class="Symbol">→</a> <a id="4104" class="Symbol">(</a><a id="4105" href="Ledger.Dijkstra.Specification.Script.Validation.html#585" class="InductiveConstructor">Spend</a>  <a id="4112" href="Ledger.Dijkstra.Specification.Script.Validation.html#4095" class="Bound">i</a> <a id="4114" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4116" href="Ledger.Core.Specification.Address.html#2639" class="Function">payCred</a> <a id="4124" class="Symbol">(</a><a id="4125" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4131" href="Ledger.Dijkstra.Specification.Script.Validation.html#4099" class="Bound">o</a><a id="4132" class="Symbol">)))</a> <a id="4136" class="Symbol">((</a><a id="4138" href="Ledger.Dijkstra.Specification.Script.Validation.html#4040" class="Bound">utxo</a> <a id="4143" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="4145" class="Symbol">(</a><a id="4146" href="Ledger.Dijkstra.Specification.Transaction.html#3741" class="Field">txIns</a> <a id="4152" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="4154" href="Ledger.Dijkstra.Specification.Transaction.html#3817" class="Field">collateralInputs</a><a id="4170" class="Symbol">))</a> <a id="4173" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="4174" class="Symbol">)</a>
  <a id="4178" class="Keyword">where</a> <a id="4184" class="Keyword">open</a> <a id="4189" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Module">TxBody</a> <a id="4196" href="Ledger.Dijkstra.Specification.Script.Validation.html#4045" class="Bound">txb</a>

<a id="4201" href="Ledger.Dijkstra.Specification.Script.Validation.html#3936" class="Function">credsNeeded</a> <a id="4213" href="Ledger.Dijkstra.Specification.Transaction.html#722" class="InductiveConstructor">TxLevelSub</a> <a id="4224" href="Ledger.Dijkstra.Specification.Script.Validation.html#4224" class="Bound">utxo</a> <a id="4229" href="Ledger.Dijkstra.Specification.Script.Validation.html#4229" class="Bound">txb</a> <a id="4233" class="Symbol">=</a> <a id="4235" href="Ledger.Dijkstra.Specification.Script.Validation.html#3217" class="Function">credsNeededMinusCollateral</a> <a id="4262" href="Ledger.Dijkstra.Specification.Script.Validation.html#4229" class="Bound">txb</a>
  <a id="4268" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="4270" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4275" class="Symbol">(λ</a> <a id="4278" class="Symbol">(</a><a id="4279" href="Ledger.Dijkstra.Specification.Script.Validation.html#4279" class="Bound">i</a> <a id="4281" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4283" href="Ledger.Dijkstra.Specification.Script.Validation.html#4283" class="Bound">o</a><a id="4284" class="Symbol">)</a> <a id="4286" class="Symbol">→</a> <a id="4288" class="Symbol">(</a><a id="4289" href="Ledger.Dijkstra.Specification.Script.Validation.html#585" class="InductiveConstructor">Spend</a>  <a id="4296" href="Ledger.Dijkstra.Specification.Script.Validation.html#4279" class="Bound">i</a> <a id="4298" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4300" href="Ledger.Core.Specification.Address.html#2639" class="Function">payCred</a> <a id="4308" class="Symbol">(</a><a id="4309" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4315" href="Ledger.Dijkstra.Specification.Script.Validation.html#4283" class="Bound">o</a><a id="4316" class="Symbol">)))</a> <a id="4320" class="Symbol">((</a><a id="4322" href="Ledger.Dijkstra.Specification.Script.Validation.html#4224" class="Bound">utxo</a> <a id="4327" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="4329" href="Ledger.Dijkstra.Specification.Transaction.html#3741" class="Field">txIns</a><a id="4334" class="Symbol">)</a> <a id="4336" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="4337" class="Symbol">)</a>
  <a id="4341" class="Keyword">where</a> <a id="4347" class="Keyword">open</a> <a id="4352" href="Ledger.Dijkstra.Specification.Transaction.html#3665" class="Module">TxBody</a> <a id="4359" href="Ledger.Dijkstra.Specification.Script.Validation.html#4229" class="Bound">txb</a>

<a id="valContext"></a><a id="4364" href="Ledger.Dijkstra.Specification.Script.Validation.html#4364" class="Function">valContext</a> <a id="4375" class="Symbol">:</a> <a id="4377" href="Ledger.Dijkstra.Specification.Script.Validation.html#2005" class="Record">TxInfo</a> <a id="4384" class="Symbol">→</a> <a id="4386" href="Ledger.Dijkstra.Specification.Script.Validation.html#421" class="Datatype">ScriptPurpose</a> <a id="4400" class="Symbol">→</a> <a id="4402" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a>
<a id="4407" href="Ledger.Dijkstra.Specification.Script.Validation.html#4364" class="Function">valContext</a> <a id="4418" href="Ledger.Dijkstra.Specification.Script.Validation.html#4418" class="Bound">txinfo</a> <a id="4425" href="Ledger.Dijkstra.Specification.Script.Validation.html#4425" class="Bound">sp</a> <a id="4428" class="Symbol">=</a> <a id="4430" href="Ledger.Conway.Specification.Script.Base.html#2007" class="Function">toData</a> <a id="4437" class="Symbol">(</a><a id="4438" href="Ledger.Dijkstra.Specification.Script.Validation.html#4418" class="Bound">txinfo</a> <a id="4445" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4447" href="Ledger.Dijkstra.Specification.Script.Validation.html#4425" class="Bound">sp</a><a id="4449" class="Symbol">)</a>

<a id="txOutToDataHash"></a><a id="4452" href="Ledger.Dijkstra.Specification.Script.Validation.html#4452" class="Function">txOutToDataHash</a> <a id="4468" class="Symbol">:</a> <a id="4470" href="Ledger.Dijkstra.Specification.Transaction.html#2863" class="Function">TxOut</a> <a id="4476" class="Symbol">→</a> <a id="4478" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4484" href="Ledger.Conway.Specification.Script.Base.html#1723" class="Function">DataHash</a>
<a id="4493" href="Ledger.Dijkstra.Specification.Script.Validation.html#4452" class="Function">txOutToDataHash</a> <a id="4509" class="Symbol">(_</a> <a id="4512" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4514" class="Symbol">_</a> <a id="4516" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4518" href="Ledger.Dijkstra.Specification.Script.Validation.html#4518" class="Bound">d</a> <a id="4520" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4522" class="Symbol">_)</a> <a id="4525" class="Symbol">=</a> <a id="4527" href="Ledger.Dijkstra.Specification.Script.Validation.html#4518" class="Bound">d</a> <a id="4529" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="4533" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="4541" href="Ledger.Dijkstra.Specification.Script.Validation.html#4541" class="Function">txOutToP2Script</a>
  <a id="4559" class="Symbol">:</a> <a id="4561" href="Ledger.Dijkstra.Specification.Transaction.html#2944" class="Function">UTxO</a> <a id="4566" class="Symbol">→</a> <a id="4568" class="Symbol">(</a><a id="4569" href="Ledger.Dijkstra.Specification.Transaction.html#3418" class="Record">Tx</a> <a id="4572" href="Ledger.Dijkstra.Specification.Script.Validation.html#783" class="Generalizable">ℓ</a><a id="4573" class="Symbol">)</a>
  <a id="4577" class="Symbol">→</a> <a id="4579" href="Ledger.Dijkstra.Specification.Transaction.html#2863" class="Function">TxOut</a> <a id="4585" class="Symbol">→</a> <a id="4587" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4593" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a>
<a id="4602" href="Ledger.Dijkstra.Specification.Script.Validation.html#4541" class="Function">txOutToP2Script</a> <a id="4618" href="Ledger.Dijkstra.Specification.Script.Validation.html#4618" class="Bound">utxo</a> <a id="4623" href="Ledger.Dijkstra.Specification.Script.Validation.html#4623" class="Bound">tx</a> <a id="4626" class="Symbol">(</a><a id="4627" href="Ledger.Dijkstra.Specification.Script.Validation.html#4627" class="Bound">a</a> <a id="4629" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4631" class="Symbol">_)</a> <a id="4634" class="Symbol">=</a>
  <a id="4638" class="Keyword">do</a> <a id="4641" href="Ledger.Dijkstra.Specification.Script.Validation.html#4641" class="Bound">sh</a> <a id="4644" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4646" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a> <a id="4658" class="Symbol">(</a><a id="4659" href="Ledger.Core.Specification.Address.html#2639" class="Function">payCred</a> <a id="4667" href="Ledger.Dijkstra.Specification.Script.Validation.html#4627" class="Bound">a</a><a id="4668" class="Symbol">)</a>
     <a id="4675" href="Ledger.Dijkstra.Specification.Script.Validation.html#4675" class="Bound">s</a>  <a id="4678" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4680" href="Ledger.Dijkstra.Specification.Transaction.html#9224" class="Function">lookupScriptHash</a> <a id="4697" href="Ledger.Dijkstra.Specification.Script.Validation.html#4641" class="Bound">sh</a> <a id="4700" href="Ledger.Dijkstra.Specification.Script.Validation.html#4623" class="Bound">tx</a> <a id="4703" href="Ledger.Dijkstra.Specification.Script.Validation.html#4618" class="Bound">utxo</a>
     <a id="4713" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="4724" href="Ledger.Dijkstra.Specification.Script.Validation.html#4675" class="Bound">s</a>

<a id="4727" class="Comment">-- opaque</a>
<a id="4737" class="Comment">--   collectP2ScriptsWithContext</a>
<a id="4770" class="Comment">--     : PParams → (Tx ℓ) → UTxO</a>
<a id="4803" class="Comment">--     → List (P2Script × List Data × ExUnits × CostModel)</a>
<a id="4862" class="Comment">--   collectP2ScriptsWithContext pp tx utxo</a>
<a id="4906" class="Comment">--     = setToList</a>
<a id="4925" class="Comment">--     $ mapPartial (λ (sp , c) → if isScriptObj c</a>
<a id="4976" class="Comment">--                                 then (λ {sh} → toScriptInput sp sh)</a>
<a id="5047" class="Comment">--                                 else nothing)</a>
<a id="5096" class="Comment">--     $ credsNeeded utxo (TxBodyOf tx)</a>
<a id="5136" class="Comment">--     where</a>
<a id="5149" class="Comment">--       toScriptInput</a>
<a id="5172" class="Comment">--         : ScriptPurpose → ScriptHash</a>
<a id="5212" class="Comment">--         → Maybe (P2Script × List Data × ExUnits × CostModel)</a>
<a id="5276" class="Comment">--       toScriptInput sp sh =</a>
<a id="5307" class="Comment">--         do s ← lookupScriptHash sh tx utxo</a>
<a id="5353" class="Comment">--            p2s ← toP2Script s</a>
<a id="5386" class="Comment">--            (rdmr , exunits) ← indexedRdmrs tx sp</a>
<a id="5438" class="Comment">--            let data&#39;     = maybe [_] [] (getDatum tx utxo sp) ++ rdmr ∷ [ valContext (txInfo (language p2s) pp utxo tx) sp ]</a>
<a id="5566" class="Comment">--                costModel = PParams.costmdls pp</a>
<a id="5616" class="Comment">--            just (p2s , data&#39; , exunits , costModel)</a>

<a id="evalP2Scripts"></a><a id="5672" href="Ledger.Dijkstra.Specification.Script.Validation.html#5672" class="Function">evalP2Scripts</a> <a id="5686" class="Symbol">:</a> <a id="5688" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5693" class="Symbol">(</a><a id="5694" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="5703" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5705" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5710" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="5715" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5717" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="5725" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5727" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="5736" class="Symbol">)</a> <a id="5738" class="Symbol">→</a> <a id="5740" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5745" href="Ledger.Dijkstra.Specification.Script.Validation.html#5672" class="Function">evalP2Scripts</a> <a id="5759" class="Symbol">=</a> <a id="5761" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="5765" class="Symbol">(λ</a> <a id="5768" class="Symbol">(</a><a id="5769" href="Ledger.Dijkstra.Specification.Script.Validation.html#5769" class="Bound">s</a> <a id="5771" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5773" href="Ledger.Dijkstra.Specification.Script.Validation.html#5773" class="Bound">d</a> <a id="5775" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5777" href="Ledger.Dijkstra.Specification.Script.Validation.html#5777" class="Bound">eu</a> <a id="5780" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5782" href="Ledger.Dijkstra.Specification.Script.Validation.html#5782" class="Bound">cm</a><a id="5784" class="Symbol">)</a> <a id="5786" class="Symbol">→</a> <a id="5788" href="Ledger.Dijkstra.Specification.Abstract.html#898" class="Field">runPLCScript</a> <a id="5801" href="Ledger.Dijkstra.Specification.Script.Validation.html#5782" class="Bound">cm</a> <a id="5804" href="Ledger.Dijkstra.Specification.Script.Validation.html#5769" class="Bound">s</a> <a id="5806" href="Ledger.Dijkstra.Specification.Script.Validation.html#5777" class="Bound">eu</a> <a id="5809" href="Ledger.Dijkstra.Specification.Script.Validation.html#5773" class="Bound">d</a><a id="5810" class="Symbol">)</a>

</pre></body></html>